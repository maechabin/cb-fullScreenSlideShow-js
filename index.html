<!doctype>

<html>

<head>

<meta charset="utf-8">
<style>
body {
  margin: 0;
  padding: 0;
}
</style>
</head>

<body>
<div class="image">aaaaaa</div>


<script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
<script>
(function () {
  var img = [
    "http://jsrun.it/assets/W/j/R/b/WjRbr.jpg",
    "http://jsrun.it/assets/O/R/d/T/ORdTy.jpg",
    "http://jsrun.it/assets/E/0/s/p/E0spJ.jpg"
  ];
  var image = $(".image");
  var imgLength = img.lengh;
  var i = 0;

  var div1 = $("<div>");
  var div2 = $("<div>");

  image.css({
    "z-index": 999,
    "position": "relative",
    "width": "100vw",
    "height": "100vh",
    "background-color": "transparent"
  });

  var divStyle = {
    "position": "absolute",
    "top": 0,
    "left": 0,
    "width": "100%",
    "height": "100%",
    "background-size": "cover",
    "background-position": "center"
  };
  var div1Style = {
    "z-index": 1,
    "background-image": "url(" + img[0] + ")"
  };
  var div2Style = {
    "z-index": 0,
    "background-image": "url(" + img[1] + ")"
  };

  div1.css($.extend({}, divStyle, div1Style));
  div2.css($.extend({}, divStyle, div2Style));

  $.each(img, function () {
    $("<img>").attr("src", this);
  });

  image.after(div1, div2);


  var timer = setInterval(changeImg, 5000);
  var diplayImgFlag = "div1"

  function changeImg() {

    if (i >= img.length) {
      i = 0;
    }

    if (displayImgFlag === "div1") {
      div1.stop().animate({"opacity": "0"}, 600);
      div2.css({
        "z-index": 1
      });
      div1.css({
        "z-index": 0,
        "background-image": "url(" + img[i + 2] + ")"
      });
      displayImgFlag = "div2";
    }

    if (displayImgFlag === "div2") {
      div2.stop().animate({"opacity": "0"}, 600);
      div1.css({
        "z-index": 1
      });
      div2.css({
        "z-index": 0,
        "background-image": "url(" + img[i + 2] + ")"
      });
      displayImgFlag = "div1";
    }


    i++;
  }
})();
</script>
</body>

</html>
